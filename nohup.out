
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks.py:21: DtypeWarning: Columns (8,9,10,11,12,13,14,15,16,17) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks.py:21: DtypeWarning: Columns (8,9,10,11,12,13,14,15,16,17) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03411              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05391              |    1.58061     |       0.01980       |
|    Treat on Vacuna only at t1   |    NA   |             0.03145              |    0.92205     |       -0.00266      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03095              |    0.90754     |       -0.00315      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01815              |    0.53228     |       -0.01595      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:15:28.926967
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03440              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05134              |    1.49238     |       0.01694       |
|    Treat on Vacuna only at t1   |    NA   |             0.03263              |    0.94861     |       -0.00177      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03217              |    0.93519     |       -0.00223      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01906              |    0.55416     |       -0.01534      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:28:31.604673
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03361              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05172              |    1.53868     |       0.01811       |
|    Treat on Vacuna only at t1   |    NA   |             0.03106              |    0.92421     |       -0.00255      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03057              |    0.90941     |       -0.00304      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01928              |    0.57364     |       -0.01433      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:39:52.270833
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03279              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05107              |    1.55713     |       0.01827       |
|    Treat on Vacuna only at t1   |    NA   |             0.03090              |    0.94221     |       -0.00190      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03043              |    0.92776     |       -0.00237      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01903              |    0.58016     |       -0.01377      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:51:32.994207
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03306              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05270              |    1.59402     |       0.01964       |
|    Treat on Vacuna only at t1   |    NA   |             0.03096              |    0.93648     |       -0.00210      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03044              |    0.92083     |       -0.00262      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02002              |    0.60567     |       -0.01304      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:05:00.524377
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03266              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05188              |    1.58839     |       0.01922       |
|    Treat on Vacuna only at t1   |    NA   |             0.03012              |    0.92211     |       -0.00254      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02958              |    0.90569     |       -0.00308      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01919              |    0.58751     |       -0.01347      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:18:32.432739
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03833              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05607              |    1.46297     |       0.01774       |
|    Treat on Vacuna only at t1   |    NA   |             0.03634              |    0.94823     |       -0.00198      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03586              |    0.93556     |       -0.00247      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02212              |    0.57715     |       -0.01621      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:30:11.764343
1
2
3
start fitting parametric model.
start simulating.
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04777 |             0.20669              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.27182              |    1.31510     |       0.06513       |
|    Treat on Vacuna only at t1   |    NA   |             0.20085              |    0.97176     |       -0.00584      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.19988              |    0.96707     |       -0.00681      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.19659              |    0.95114     |       -0.01010      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:18:01.940377
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04622 |             0.19135              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.25451              |    1.33011     |       0.06317       |
|    Treat on Vacuna only at t1   |    NA   |             0.18602              |    0.97218     |       -0.00532      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.18506              |    0.96716     |       -0.00628      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18326              |    0.95774     |       -0.00809      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:34:35.281160
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04723 |             0.19857              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.27268              |    1.37321     |       0.07411       |
|    Treat on Vacuna only at t1   |    NA   |             0.19037              |    0.95869     |       -0.00820      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.18916              |    0.95258     |       -0.00942      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18429              |    0.92808     |       -0.01428      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
0:49:48.759779
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04709 |             0.20343              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.26586              |    1.30687     |       0.06243       |
|    Treat on Vacuna only at t1   |    NA   |             0.19706              |    0.96870     |       -0.00637      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.19612              |    0.96407     |       -0.00731      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.19297              |    0.94860     |       -0.01046      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:05:51.194120
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04745 |             0.19669              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.25083              |    1.27523     |       0.05414       |
|    Treat on Vacuna only at t1   |    NA   |             0.19184              |    0.97531     |       -0.00486      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.19103              |    0.97119     |       -0.00567      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18698              |    0.95064     |       -0.00971      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:22:56.593039
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04754 |             0.20490              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.26465              |    1.29159     |       0.05975       |
|    Treat on Vacuna only at t1   |    NA   |             0.19981              |    0.97517     |       -0.00509      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.19909              |    0.97161     |       -0.00582      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.19591              |    0.95610     |       -0.00900      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:38:47.405880
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04763 |             0.19510              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.24753              |    1.26870     |       0.05242       |
|    Treat on Vacuna only at t1   |    NA   |             0.18945              |    0.97104     |       -0.00565      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.18861              |    0.96671     |       -0.00649      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18355              |    0.94081     |       -0.01155      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:54:24.418604
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03267              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05265              |    1.61147     |       0.01998       |
|    Treat on Vacuna only at t1   |    NA   |             0.03065              |    0.93803     |       -0.00202      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03014              |    0.92248     |       -0.00253      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01943              |    0.59480     |       -0.01324      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:41:37.313167
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03217              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.05155              |    1.60262     |       0.01938       |
|    Treat on Vacuna only at t1   |    NA   |             0.03005              |    0.93429     |       -0.00211      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02954              |    0.91846     |       -0.00262      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01866              |    0.57999     |       -0.01351      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:54:44.301783
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.03265              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04991              |    1.52864     |       0.01726       |
|    Treat on Vacuna only at t1   |    NA   |             0.03066              |    0.93902     |       -0.00199      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03018              |    0.92434     |       -0.00247      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01981              |    0.60678     |       -0.01284      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:08:15.356686
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04721 |             0.19183              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.24941              |    1.30016     |       0.05758       |
|    Treat on Vacuna only at t1   |    NA   |             0.18571              |    0.96808     |       -0.00612      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.18474              |    0.96307     |       -0.00708      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18089              |    0.94300     |       -0.01093      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:10:12.037268
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04786 |             0.19615              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.25070              |    1.27814     |       0.05456       |
|    Treat on Vacuna only at t1   |    NA   |             0.19250              |    0.98140     |       -0.00365      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.19220              |    0.97988     |       -0.00395      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18965              |    0.96689     |       -0.00649      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:22:43.313711
1
2
3
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04818 |             0.19240              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.25288              |    1.31434     |       0.06048       |
|    Treat on Vacuna only at t1   |    NA   |             0.18636              |    0.96860     |       -0.00604      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.18558              |    0.96458     |       -0.00682      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.18228              |    0.94742     |       -0.01012      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:34:37.225684





/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (8,9,10,11,12,13,14,15,16,17) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00832              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01690              |    2.03042     |       0.00857       |
|    Treat on Vacuna only at t1   |    NA   |             0.00806              |    0.96850     |       -0.00026      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00790              |    0.94966     |       -0.00042      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00592              |    0.71154     |       -0.00240      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:10:38.320524
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00825              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01582              |    1.91628     |       0.00756       |
|    Treat on Vacuna only at t1   |    NA   |             0.00800              |    0.96972     |       -0.00025      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00787              |    0.95362     |       -0.00038      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00543              |    0.65798     |       -0.00282      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:19:00.249172
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00878              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01706              |    1.94305     |       0.00828       |
|    Treat on Vacuna only at t1   |    NA   |             0.00858              |    0.97640     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00843              |    0.95996     |       -0.00035      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00612              |    0.69637     |       -0.00267      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:27:55.529558
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00858              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01617              |    1.88546     |       0.00760       |
|    Treat on Vacuna only at t1   |    NA   |             0.00839              |    0.97846     |       -0.00018      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00825              |    0.96185     |       -0.00033      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00552              |    0.64405     |       -0.00305      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:36:33.461713
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00784              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01585              |    2.02086     |       0.00801       |
|    Treat on Vacuna only at t1   |    NA   |             0.00766              |    0.97598     |       -0.00019      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00755              |    0.96243     |       -0.00029      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00519              |    0.66232     |       -0.00265      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
5:45:57.547034
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00867              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01692              |    1.95249     |       0.00826       |
|    Treat on Vacuna only at t1   |    NA   |             0.00847              |    0.97704     |       -0.00020      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00834              |    0.96168     |       -0.00033      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00574              |    0.66176     |       -0.00293      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:54:53.099521
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00807              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01733              |    2.14718     |       0.00926       |
|    Treat on Vacuna only at t1   |    NA   |             0.00785              |    0.97289     |       -0.00022      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00771              |    0.95564     |       -0.00036      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00544              |    0.67355     |       -0.00264      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
8:04:22.353034
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.01241              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01945              |    1.56728     |       0.00704       |
|    Treat on Vacuna only at t1   |    NA   |             0.01220              |    0.98323     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.01205              |    0.97081     |       -0.00036      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00790              |    0.63679     |       -0.00451      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:13:49.074355
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.01030              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01942              |    1.88557     |       0.00912       |
|    Treat on Vacuna only at t1   |    NA   |             0.01008              |    0.97917     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00994              |    0.96529     |       -0.00036      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00732              |    0.71037     |       -0.00298      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
10:23:44.437780
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00870              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01519              |    1.74599     |       0.00649       |
|    Treat on Vacuna only at t1   |    NA   |             0.00852              |    0.97909     |       -0.00018      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00839              |    0.96363     |       -0.00032      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00628              |    0.72223     |       -0.00242      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
11:33:04.631482





Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 21, in <module>
    all_data = pd.read_csv('included_cohort_prep.csv')
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 626, in _read
    return parser.read(nrows)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1923, in read
    ) = self._engine.read(  # type: ignore[attr-defined]
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/io/parsers/c_parser_wrapper.py", line 234, in read
    chunks = self._reader.read_low_memory(nrows)
  File "parsers.pyx", line 838, in pandas._libs.parsers.TextReader.read_low_memory
  File "parsers.pyx", line 905, in pandas._libs.parsers.TextReader._read_rows
  File "parsers.pyx", line 874, in pandas._libs.parsers.TextReader._tokenize_rows
  File "parsers.pyx", line 891, in pandas._libs.parsers.TextReader._check_tokenize_status
  File "parsers.pyx", line 2061, in pandas._libs.parsers.raise_parser_error
pandas.errors.ParserError: Error tokenizing data. C error: Calling read(nbytes) on source failed. Try engine='python'.
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (8,9,10,11,12,13,14,15,16,17) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
0         1002069_0     0         NaN  0.0      68.072280                0  ...                0.00              0.00                   0.0               0.000          0.0     1.759304
10       84264993_0     0         NaN  0.0      26.249112                0  ...                0.00              0.00                   0.0               0.000          0.0     1.257663
11       11149112_0     0         NaN  0.0      41.242894                0  ...                0.00              0.00                   0.0               0.000          0.0     2.274273
14       12444300_0     0         NaN  0.0      47.634481                0  ...                0.00              0.00                   0.0               0.000          0.0     1.478081
15       11965735_0     0         NaN  0.0      19.547380                0  ...                0.00              0.00                   0.0               0.000          0.0     0.741186
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998854   6095091_3     2         NaN  NaN      43.480987                3  ...               26.20             81.09                   0.0              14.201          1.0     1.296828
8998857   2071651_3     2         NaN  NaN      69.323738                3  ...               35.60             77.00                   1.0              15.776          1.0     1.037120
8998866   1278436_3     2         NaN  NaN      53.732368                3  ...               22.23             87.00                   0.0              15.932          1.0     1.019606
8998868    304806_3     2         NaN  NaN      37.769640                3  ...               22.93             70.00                   0.0               5.605          1.0     0.790579
8998871   1288809_3     2         NaN  NaN      82.527101                3  ...               19.69             87.00                   0.0               0.071          1.0     0.916682

[3917450 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   1002069_0     2         NaN NaN      68.072280                0  ...           18.860000         87.779745                   0.0            2.346001          0.0     1.233250
5999249   7198410_0     2         NaN NaN      36.567237                3  ...           32.070000        102.710000                   0.0            5.998000          1.0     0.914236
5999250  10095176_0     2         NaN NaN      55.537065                2  ...           21.870000         86.698320                   1.0            0.000000          1.0     1.085677
5999251   2857021_0     2         NaN NaN      45.359540                2  ...           15.480000         89.400000                   1.0            1.921000          1.0     1.038452
5999252   7446951_0     2         NaN NaN      31.915138                2  ...           17.780000         83.006954                   0.0            0.402000          1.0     1.063892
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867   1760312_3     2         NaN NaN      45.359540                1  ...           26.470000         90.000000                   0.0            1.365000          0.0     0.914965
8998868    304806_3     2         NaN NaN      37.769640                3  ...           22.930000         70.000000                   0.0            5.605000          1.0     0.790579
8998869  83927125_3     2         NaN NaN      51.297359                0  ...           21.340559         88.973570                   0.0            2.674268          0.0     1.348177
8998870   6473275_3     2         NaN NaN      62.486417                2  ...           33.570000         68.000000                   0.0           15.346000          1.0     1.010865
8998871   1288809_3     2         NaN NaN      82.527101                3  ...           19.690000         87.000000                   0.0            0.071000          1.0     0.916682

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00742              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01218              |    1.64070     |       0.00476       |
|    Treat on Vacuna only at t1   |    NA   |             0.00724              |    0.97514     |       -0.00018      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00718              |    0.96689     |       -0.00025      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00387              |    0.52113     |       -0.00355      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:07:54.140136
start fitting parametric model.
(8998872, 58)
                NIA  time               DATA_DM_min   DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
4        39524765_0     0                       NaN  0.0      41.999450  ...           0.000000                   0.0            0.00000          0.0     1.162744
5        62764781_0     0                       NaN  0.0      53.975559  ...           0.000000                   0.0            0.00000          0.0     1.090205
14        4766781_0     0  2006-08-24T00:00:00.000Z  1.0      50.775860  ...           0.000000                   0.0            0.00000          0.0     2.073829
19       23134833_0     0                       NaN  0.0      49.422524  ...           0.000000                   0.0            0.00000          0.0     1.082607
21       48794767_0     0                       NaN  0.0      47.304757  ...           0.000000                   0.0            0.00000          0.0     1.320489
...             ...   ...                       ...  ...            ...  ...                ...                   ...                ...          ...          ...
8998858   4171363_3     2                       NaN  NaN      51.264958  ...          99.000000                   0.0           12.35300          1.0     1.250753
8998861   1610195_3     2                       NaN  NaN      51.033958  ...         104.000000                   0.0            9.54000          1.0     1.163018
8998866   2337866_3     2                       NaN  NaN      46.559923  ...          91.000000                   0.0            2.02000          1.0     0.947262
8998869  10677069_3     2                       NaN  NaN       2.996013  ...          84.939767                   0.0            3.03400          1.0     1.042687
8998870  83537425_3     2                       NaN  NaN      38.275197  ...          87.507470                   0.0            2.62207          1.0     0.972470

[3915066 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   2696599_0     2         NaN NaN      30.821807                2  ...           24.780000         91.000000                   0.0             5.89200          1.0     1.011320
5999249   1764578_0     2         NaN NaN      52.048451                3  ...           36.080000         98.507581                   0.0            36.99200          1.0     0.886049
5999250   1003104_0     2         NaN NaN      39.049733                3  ...           30.780000         86.000000                   0.0             4.92700          1.0     0.862434
5999251   4174758_0     2         NaN NaN       1.445904                2  ...           26.490000         85.000000                   0.0            14.44000          1.0     1.099532
5999252  39524765_0     2         NaN NaN      41.999450                0  ...           27.969658         98.186887                   0.0             0.00000          0.0     0.854461
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867   4774105_3     2         NaN NaN      36.797557                2  ...           25.010000         82.890000                   0.0             3.06800          1.0     0.939161
8998868   9617080_3     2         NaN NaN      40.088479                1  ...           26.440000         87.387415                   0.0             7.19800          0.0     1.009452
8998869  10677069_3     2         NaN NaN       2.996013                3  ...           25.319878         84.939767                   0.0             3.03400          1.0     1.042687
8998870  83537425_3     2         NaN NaN      38.275197                3  ...           23.771658         87.507470                   0.0             2.62207          1.0     0.972470
8998871   2204694_3     2         NaN NaN      50.919598                2  ...           17.670000        141.000000                   0.0             1.13800          1.0     1.092915

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00472              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00845              |    1.78926     |       0.00373       |
|    Treat on Vacuna only at t1   |    NA   |             0.00449              |    0.95196     |       -0.00023      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00450              |    0.95308     |       -0.00022      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00334              |    0.70766     |       -0.00138      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:14:16.951250
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
9        84033749_0     0         NaN  0.0      56.274057                0  ...                0.00          0.000000                   0.0               0.000          0.0     0.806554
12       82386041_0     0         NaN  0.0      37.314869                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.708457
22       79804792_0     0         NaN  0.0      44.274294                0  ...                0.00          0.000000                   0.0               0.000          0.0     0.893888
23       11805977_0     0         NaN  0.0      32.568911                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.041191
24         349668_0     0         NaN  0.0      36.218757                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.491487
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998858  10674572_3     2         NaN  NaN      22.544616                3  ...               30.99         88.159342                   0.0               1.822          1.0     1.102352
8998861   9749116_3     2         NaN  NaN      36.619364                3  ...               32.25        102.000000                   0.0               4.023          1.0     1.123546
8998862   1757504_3     2         NaN  NaN      46.898152                3  ...               26.45         93.700000                   0.0               4.596          1.0     0.996165
8998868   1257220_3     2         NaN  NaN      19.174582                3  ...               25.56         99.000000                   0.0              15.735          1.0     0.837367
8998869   1889862_3     2         NaN  NaN      43.456184                3  ...               27.66         84.690000                   0.0              18.435          1.0     1.060854

[3916329 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248    109590_0     2         NaN NaN      31.915138                1  ...           21.610000         75.680000                   1.0              15.206          0.0     0.837554
5999249   5795818_0     2         NaN NaN      36.218757                1  ...           20.630000         83.537100                   0.0               1.468          0.0     0.899954
5999250   5738027_0     2         NaN NaN       8.776737                3  ...           23.111184         83.703062                   0.0               0.000          1.0     1.002825
5999251   8607338_0     2         NaN NaN      39.815150                2  ...           33.180000         88.495933                   0.0               4.420          1.0     1.056451
5999252  10524111_0     2         NaN NaN      19.213225                2  ...           15.540000         78.840721                   0.0               0.798          1.0     1.158888
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867   1346940_3     2         NaN NaN      32.199623                1  ...           25.416602         82.134852                   0.0               0.000          0.0     0.990332
8998868   1257220_3     2         NaN NaN      19.174582                3  ...           25.560000         99.000000                   0.0              15.735          1.0     0.837367
8998869   1889862_3     2         NaN NaN      43.456184                3  ...           27.660000         84.690000                   0.0              18.435          1.0     1.060854
8998870  25824757_3     2         NaN NaN      44.908957                0  ...           16.950000         90.158333                   0.0               0.000          0.0     0.966075
8998871    992045_3     2         NaN NaN      36.083087                2  ...           25.716996         73.000000                   0.0               3.503          1.0     1.115426

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00739              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01026              |    1.38829     |       0.00287       |
|    Treat on Vacuna only at t1   |    NA   |             0.00707              |    0.95581     |       -0.00033      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00698              |    0.94487     |       -0.00041      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00365              |    0.49360     |       -0.00374      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:21:16.030400
start fitting parametric model.
(8998872, 58)
                NIA  time               DATA_DM_min   DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
2        10700603_0     0  2010-02-23T00:00:00.000Z  1.0      41.018410  ...           0.000000                   0.0              0.000          0.0     2.454141
6        73464771_0     0                       NaN  0.0      41.999450  ...           0.000000                   0.0              0.000          0.0     0.868769
11       13524436_0     0                       NaN  0.0      29.993543  ...           0.000000                   0.0              0.000          0.0     0.930819
32       19334339_0     0                       NaN  0.0      51.141867  ...           0.000000                   0.0              0.000          0.0     0.819782
36       24085121_0     0                       NaN  0.0      40.828608  ...           0.000000                   0.0              0.000          0.0     0.878733
...             ...   ...                       ...  ...            ...  ...                ...                   ...                ...          ...          ...
8998861   9658942_3     2                       NaN  NaN      10.679897  ...          96.000000                   0.0              6.683          1.0     1.156486
8998863   7161872_3     2                       NaN  NaN      41.242894  ...          90.000000                   0.0             14.367          1.0     0.865503
8998865    829878_3     2                       NaN  NaN            NaN  ...          88.300000                   0.0              5.370          1.0     1.165058
8998869    653902_3     2                       NaN  NaN      43.480987  ...          87.643696                   0.0             23.382          1.0     0.951559
8998870   4417487_3     2                       NaN  NaN      40.376925  ...          82.000000                   0.0              2.278          1.0     0.920642

[3917378 rows x 58 columns]
                NIA  time               DATA_DM_min  DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   5955359_0     2                       NaN NaN            NaN  ...          91.703331                   0.0              3.522          1.0     1.119131
5999249   7172382_0     2                       NaN NaN      48.805211  ...          98.000000                   0.0              4.640          1.0     0.886049
5999250  10700603_0     2  2010-02-23T00:00:00.000Z NaN      41.018410  ...          83.351273                   0.0              7.553          0.0     0.884672
5999251   5511508_0     2                       NaN NaN      64.880552  ...         106.320000                   0.0              0.699          1.0     1.081250
5999252   1917621_0     2                       NaN NaN      41.209182  ...         106.000000                   0.0             16.263          1.0     0.898644
...             ...   ...                       ...  ..            ...  ...                ...                   ...                ...          ...          ...
8998867   6395697_3     2                       NaN NaN      35.041674  ...          70.639953                   0.0              2.636          1.0     1.131166
8998868  10840514_3     2                       NaN NaN            NaN  ...          81.450000                   0.0              0.365          0.0     1.206078
8998869    653902_3     2                       NaN NaN      43.480987  ...          87.643696                   0.0             23.382          1.0     0.951559
8998870   4417487_3     2                       NaN NaN      40.376925  ...          82.000000                   0.0              2.278          1.0     0.920642
8998871  12409461_3     2                       NaN NaN      29.578433  ...          78.719433                   0.0              1.885          0.0     1.224031

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00539              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01288              |    2.38794     |       0.00748       |
|    Treat on Vacuna only at t1   |    NA   |             0.00518              |    0.96111     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00511              |    0.94685     |       -0.00029      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00345              |    0.63908     |       -0.00195      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:28:02.160154
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
2         5706639_0     0         NaN  0.0      51.141867                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.036811
3        10236108_0     0         NaN  0.0      41.209182                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.816958
7        27524757_0     0         NaN  0.0      50.627094                0  ...            0.000000          0.000000                   0.0               0.000          0.0     2.201048
13       47984788_0     0         NaN  0.0      32.199623                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.004749
25       83554164_0     0         NaN  0.0      33.723876                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.920826
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998866  17683849_3     2         NaN  NaN      36.619364                3  ...           22.291764         83.549021                   0.0               3.066          1.0     1.032648
8998867   2997997_3     2         NaN  NaN      36.816054                3  ...           26.510000        104.520000                   0.0               3.762          1.0     1.070571
8998869   1823804_3     2         NaN  NaN      44.402963                3  ...           28.970000        112.000000                   0.0               3.209          1.0     1.008169
8998870   5843767_3     2         NaN  NaN      26.249112                3  ...           20.247390         85.261060                   0.0               2.720          1.0     0.961881
8998871   9522738_3     2         NaN  NaN      18.395778                3  ...           19.130000         88.300000                   0.0               0.000          1.0     0.909074

[3916321 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248  10384670_0     2         NaN NaN      15.805092                2  ...            27.14000          76.00000                   0.0               5.025          1.0     1.082138
5999249   2001727_0     2         NaN NaN      29.305315                2  ...            19.63000          87.00000                   0.0               1.512          1.0     1.020250
5999250   5706639_0     2         NaN NaN      51.141867                0  ...            31.25000          85.00000                   0.0               1.744          0.0     1.204538
5999251  10236108_0     2         NaN NaN      41.209182                0  ...            28.30000          73.00000                   0.0               1.532          0.0     0.715979
5999252  10206657_0     2         NaN NaN            NaN                2  ...            20.51000          75.00000                   0.0               6.920          1.0     1.128824
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867   2997997_3     2         NaN NaN      36.816054                3  ...            26.51000         104.52000                   0.0               3.762          1.0     1.070571
8998868  10768851_3     2         NaN NaN      31.915138                2  ...            23.56000          81.09000                   0.0               3.966          1.0     1.046843
8998869   1823804_3     2         NaN NaN      44.402963                3  ...            28.97000         112.00000                   0.0               3.209          1.0     1.008169
8998870   5843767_3     2         NaN NaN      26.249112                3  ...            20.24739          85.26106                   0.0               2.720          1.0     0.961881
8998871   9522738_3     2         NaN NaN      18.395778                3  ...            19.13000          88.30000                   0.0               0.000          1.0     0.909074

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00536              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00975              |    1.81903     |       0.00439       |
|    Treat on Vacuna only at t1   |    NA   |             0.00515              |    0.96146     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00510              |    0.95237     |       -0.00026      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00379              |    0.70698     |       -0.00157      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
5:35:05.602885
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
3        84100084_0     0         NaN  0.0      53.107634                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.917336
4        11577803_0     0         NaN  0.0      75.169623                0  ...            0.000000          0.000000                   0.0               0.000          0.0     2.138845
6        11653094_0     0         NaN  0.0      41.843877                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.453955
8         4302017_0     0         NaN  0.0      44.329413                0  ...            0.000000          0.000000                   0.0               0.000          0.0     2.009050
13       40364797_0     0         NaN  0.0      17.274492                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.994973
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998863    430739_3     2         NaN  NaN      57.039588                3  ...           28.800000         90.100000                   0.0               2.546          1.0     0.831786
8998864   6258491_3     2         NaN  NaN      43.524173                3  ...           30.790000         89.000000                   0.0              15.008          1.0     1.122047
8998865   6609741_3     2         NaN  NaN      57.394454                3  ...           27.012348         90.397470                   0.0               0.000          1.0     1.024521
8998868  29524946_3     2         NaN  NaN      44.562579                3  ...           29.110854         91.883793                   0.0               0.000          1.0     0.766684
8998870    687680_3     2         NaN  NaN      31.523682                3  ...           28.830000         73.880000                   0.0              17.416          1.0     0.919214

[3915727 rows x 58 columns]
                NIA  time               DATA_DM_min  DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   4100683_0     2                       NaN NaN      25.622485  ...          89.000000                   0.0            0.00000          1.0     1.004531
5999249   1958209_0     2                       NaN NaN            NaN  ...          85.000000                   0.0            4.67000          1.0     0.918551
5999250  21463888_0     2                       NaN NaN      68.484286  ...          84.471813                   1.0            0.00000          1.0     1.026325
5999251  84100084_0     2                       NaN NaN      53.107634  ...          94.141319                   0.0           15.18335          0.0     0.712210
5999252  11577803_0     2                       NaN NaN      75.169623  ...          78.888068                   0.0            1.66400          0.0     0.913446
...             ...   ...                       ...  ..            ...  ...                ...                   ...                ...          ...          ...
8998867  11295816_3     2                       NaN NaN      36.903946  ...          78.580685                   0.0            0.00000          0.0     0.982651
8998868  29524946_3     2                       NaN NaN      44.562579  ...          91.883793                   0.0            0.00000          1.0     0.766684
8998869   5759350_3     2  2012-06-08T00:00:00.000Z NaN      46.571176  ...          87.097461                   0.0            9.06100          0.0     1.191218
8998870    687680_3     2                       NaN NaN      31.523682  ...          73.880000                   0.0           17.41600          1.0     0.919214
8998871  11706096_3     2                       NaN NaN      75.169623  ...          78.174203                   0.0            4.94700          1.0     1.150404

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00500              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00924              |    1.84780     |       0.00424       |
|    Treat on Vacuna only at t1   |    NA   |             0.00476              |    0.95271     |       -0.00024      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00470              |    0.93995     |       -0.00030      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00361              |    0.72123     |       -0.00139      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:42:07.846622
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
2         3265114_0     0         NaN  0.0      25.155199                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.034205
3          987819_0     0         NaN  0.0      52.521250                0  ...            0.000000          0.000000                   0.0               0.000          0.0     2.280871
16       26004889_0     0         NaN  0.0      59.182157                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.113215
17       16643971_0     0         NaN  0.0      52.048451                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.823474
22       84122765_0     0         NaN  0.0      41.999450                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.893888
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998864  10786902_3     2         NaN  NaN      45.240799                3  ...           26.170000         84.690000                   0.0               0.365          1.0     1.032984
8998865   2967645_3     2         NaN  NaN      49.671826                3  ...           25.450155         77.000000                   0.0               2.383          1.0     1.140553
8998869  10894824_3     2         NaN  NaN      59.182157                3  ...           26.840000         88.000000                   0.0               3.477          1.0     0.938897
8998870   2756630_3     2         NaN  NaN      34.557718                3  ...           32.490000         86.500000                   0.0               2.064          1.0     0.995247
8998871   4597412_3     2         NaN  NaN      13.297067                3  ...           21.670000         81.903661                   0.0               1.906          1.0     0.958783

[3916003 rows x 58 columns]
                NIA  time               DATA_DM_min  DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   2333130_0     2                       NaN NaN      62.486417  ...          83.000000                   0.0           0.000000          1.0     1.108995
5999249   6235631_0     2                       NaN NaN       3.302572  ...          97.000000                   0.0           5.147000          1.0     0.928070
5999250   3265114_0     2                       NaN NaN      25.155199  ...          86.398306                   0.0           4.178000          0.0     1.165889
5999251    987819_0     2                       NaN NaN      52.521250  ...          88.000000                   0.0           4.816648          0.0     0.785999
5999252   1459115_0     2  2022-04-17T00:00:00.000Z NaN      82.527101  ...         104.000000                   0.0          25.506000          0.0     1.266958
...             ...   ...                       ...  ..            ...  ...                ...                   ...                ...          ...          ...
8998867   7091107_3     2                       NaN NaN       2.996013  ...          80.526461                   1.0           0.000000          1.0     1.048776
8998868  16913964_3     2                       NaN NaN      18.650238  ...          83.204342                   1.0           1.748000          1.0     1.075356
8998869  10894824_3     2                       NaN NaN      59.182157  ...          88.000000                   0.0           3.477000          1.0     0.938897
8998870   2756630_3     2                       NaN NaN      34.557718  ...          86.500000                   0.0           2.064000          1.0     0.995247
8998871   4597412_3     2                       NaN NaN      13.297067  ...          81.903661                   0.0           1.906000          1.0     0.958783

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00458              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01054              |    2.30172     |       0.00596       |
|    Treat on Vacuna only at t1   |    NA   |             0.00433              |    0.94609     |       -0.00025      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00427              |    0.93363     |       -0.00030      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00326              |    0.71175     |       -0.00132      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
7:49:14.889359
start fitting parametric model.
(8998872, 58)
                NIA  time               DATA_DM_min   DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
0         8917547_0     0                       NaN  0.0      36.816054  ...           0.000000                   0.0              0.000          0.0     1.779895
7         1811619_0     0                       NaN  0.0       8.776737  ...           0.000000                   0.0              0.000          0.0     1.872249
19       83949963_0     0                       NaN  0.0      15.329363  ...           0.000000                   0.0              0.000          0.0     0.867021
26       84031776_0     0                       NaN  0.0      19.174582  ...           0.000000                   0.0              0.000          0.0     1.055051
27       15844227_0     0                       NaN  0.0      18.395778  ...           0.000000                   0.0              0.000          0.0     2.487188
...             ...   ...                       ...  ...            ...  ...                ...                   ...                ...          ...          ...
8998861   4118602_3     2                       NaN  NaN       6.810611  ...          84.211508                   0.0              0.000          1.0     1.093049
8998863   4112018_3     2  2022-05-02T00:00:00.000Z  NaN      54.872911  ...         101.840835                   0.0             10.192          1.0     0.920464
8998868   3586335_3     2                       NaN  NaN      42.341641  ...          72.000000                   0.0              4.126          1.0     0.860470
8998869    282462_3     2                       NaN  NaN      47.195426  ...          97.000000                   0.0             18.401          1.0     1.108562
8998870   2354906_3     2                       NaN  NaN      20.328464  ...          94.000000                   0.0              2.035          1.0     0.953795

[3918027 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   8917547_0     2         NaN NaN      36.816054                0  ...           27.300000         90.000000                   0.0               5.546          0.0     1.153465
5999249   2179593_0     2         NaN NaN      18.650238                2  ...           22.220000         83.866115                   0.0               0.141          1.0     0.945792
5999250   6128492_0     2         NaN NaN      23.707180                2  ...           21.150000         83.703639                   0.0              12.553          1.0     1.091593
5999251   1423688_0     2         NaN NaN      38.524903                3  ...           32.560000         96.000000                   0.0               3.092          1.0     1.103389
5999252  10203457_0     2         NaN NaN      49.502202                3  ...           19.370000         81.143318                   0.0               1.044          1.0     0.749997
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867   1426615_3     2         NaN NaN      32.959882                2  ...           23.384703         83.673634                   1.0               1.065          1.0     1.040058
8998868   3586335_3     2         NaN NaN      42.341641                3  ...           23.120000         72.000000                   0.0               4.126          1.0     0.860470
8998869    282462_3     2         NaN NaN      47.195426                3  ...           27.380000         97.000000                   0.0              18.401          1.0     1.108562
8998870   2354906_3     2         NaN NaN      20.328464                3  ...           21.080000         94.000000                   0.0               2.035          1.0     0.953795
8998871   5202804_3     2         NaN NaN      48.805211                2  ...           20.360000         69.000000                   0.0               3.171          1.0     1.031867

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00558              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00904              |    1.62017     |       0.00346       |
|    Treat on Vacuna only at t1   |    NA   |             0.00537              |    0.96215     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00528              |    0.94705     |       -0.00030      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00482              |    0.86501     |       -0.00075      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
8:56:24.005785
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
10       11212922_0     0         NaN  0.0      54.872911                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.027188
15       12681394_0     0         NaN  0.0      41.541235                0  ...            0.000000          0.000000                   0.0               0.000          0.0     0.748919
17       12765566_0     0         NaN  0.0      41.628868                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.705047
20       39434714_0     0         NaN  0.0      15.329363                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.045886
22       42164750_0     0         NaN  0.0      43.524173                0  ...            0.000000          0.000000                   0.0               0.000          0.0     1.092523
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998855   1101214_3     2         NaN  NaN       0.000000                3  ...           30.600000         88.471310                   0.0              15.079          1.0     1.070767
8998863  17964590_3     2         NaN  NaN      72.281023                3  ...           24.145704         88.966446                   0.0               4.655          1.0     0.857796
8998865   3529376_3     2         NaN  NaN      41.434054                3  ...           35.430000        103.000000                   0.0              20.372          1.0     1.098275
8998868    423958_3     2         NaN  NaN      13.297067                3  ...           23.930000         81.951680                   0.0               0.000          1.0     0.766684
8998870   5686101_3     2         NaN  NaN      41.792720                3  ...           34.000000         90.817686                   0.0               7.546          1.0     0.958719

[3916936 rows x 58 columns]
                NIA  time               DATA_DM_min  DM  ISC reescalat  ...  lag1_test_res_bg_  lag1_test_res_covid_ lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   9748985_0     2                       NaN NaN      56.274057  ...          81.000000                   0.0           5.216000          1.0     1.060484
5999249    414578_0     2                       NaN NaN      43.766425  ...          73.340000                   0.0           2.532000          1.0     1.012342
5999250  10913489_0     2  2022-09-05T00:00:00.000Z NaN      31.523682  ...          93.700000                   0.0           4.518000          0.0     0.790654
5999251   7703730_0     2                       NaN NaN      36.135603  ...          77.490000                   0.0           3.609000          1.0     1.136769
5999252   5253690_0     2                       NaN NaN      41.287988  ...          93.000000                   0.0           6.118000          1.0     0.918697
...             ...   ...                       ...  ..            ...  ...                ...                   ...                ...          ...          ...
8998867  84013733_3     2                       NaN NaN      44.738977  ...          86.904680                   0.0           1.358326          0.0     0.905138
8998868    423958_3     2                       NaN NaN      13.297067  ...          81.951680                   0.0           0.000000          1.0     0.766684
8998869  64114822_3     2                       NaN NaN      45.690671  ...         102.221775                   0.0           3.864140          0.0     1.058220
8998870   5686101_3     2                       NaN NaN      41.792720  ...          90.817686                   0.0           7.546000          1.0     0.958719
8998871  11120809_3     2                       NaN NaN      52.107531  ...          82.259225                   1.0           0.000000          1.0     1.159536

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00551              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01063              |    1.92988     |       0.00512       |
|    Treat on Vacuna only at t1   |    NA   |             0.00526              |    0.95454     |       -0.00025      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00515              |    0.93450     |       -0.00036      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00396              |    0.71886     |       -0.00155      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
10:03:31.534993
start fitting parametric model.
(8998872, 58)
                NIA  time DATA_DM_min   DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
3        11685756_0     0         NaN  0.0      40.350748                0  ...                0.00          0.000000                   0.0               0.000          0.0     2.026328
4        83730826_0     0         NaN  0.0      44.317028                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.076277
5         9591873_0     0         NaN  0.0            NaN                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.136463
16       17675075_0     0         NaN  0.0      46.960109                0  ...                0.00          0.000000                   0.0               0.000          0.0     1.275136
19       10249198_0     0         NaN  0.0      44.738977                0  ...                0.00          0.000000                   0.0               0.000          0.0     2.734317
...             ...   ...         ...  ...            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998861   9751200_3     2         NaN  NaN      32.685987                3  ...               28.74         84.000000                   0.0               5.335          1.0     1.146465
8998863   2297976_3     2         NaN  NaN      45.845873                3  ...               21.00         84.093662                   0.0               0.000          1.0     0.941870
8998864   6914896_3     2         NaN  NaN      10.679897                3  ...               17.25         82.000000                   0.0              16.778          1.0     1.118926
8998866  11087192_3     2         NaN  NaN      33.746835                3  ...               22.17         87.743500                   0.0               2.076          1.0     1.065287
8998868   2476727_3     2         NaN  NaN      23.703575                3  ...               32.05         76.000000                   0.0               7.299          1.0     0.905520

[3918739 rows x 58 columns]
                NIA  time DATA_DM_min  DM  ISC reescalat  N_vaccine_total  ...  lag1_test_res_imc_ lag1_test_res_bg_  lag1_test_res_covid_  lag1_test_res_gma_  lag1_Vacuna  weights_CCW
5999248   5990654_0     2         NaN NaN      40.088479                2  ...           27.074556         89.333594                   0.0            1.357000          1.0     1.157934
5999249   5790761_0     2         NaN NaN      35.041674                3  ...           32.860000         92.000000                   0.0           11.318000          1.0     1.089235
5999250   4375730_0     2         NaN NaN      29.024031                2  ...           27.513859         89.320670                   0.0            4.406000          1.0     1.083093
5999251  11685756_0     2         NaN NaN      40.350748                0  ...           17.310000        100.000000                   0.0            0.178000          0.0     0.807850
5999252  83730826_0     2         NaN NaN      44.317028                0  ...           13.724753        153.740442                   0.0            4.286305          0.0     1.020430
...             ...   ...         ...  ..            ...              ...  ...                 ...               ...                   ...                 ...          ...          ...
8998867  10079235_3     2         NaN NaN      49.502202                2  ...           18.560000         80.841527                   0.0            0.000000          1.0     0.930198
8998868   2476727_3     2         NaN NaN      23.703575                3  ...           32.050000         76.000000                   0.0            7.299000          1.0     0.905520
8998869  10497693_3     2         NaN NaN      43.456184                2  ...           26.130000         86.500000                   0.0            6.501000          1.0     0.708540
8998870  10121150_3     2         NaN NaN      34.557718                2  ...           19.370000         87.545446                   0.0            1.176000          1.0     1.002975
8998871   2060715_3     2         NaN NaN      35.863082                2  ...           20.700000         80.000000                   0.0            0.000000          1.0     1.154970

[2999624 rows x 58 columns]
(2249718, 58)
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       |   nan   |             0.00471              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00914              |    1.94049     |       0.00443       |
|    Treat on Vacuna only at t1   |    NA   |             0.00450              |    0.95598     |       -0.00021      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00451              |    0.95617     |       -0.00021      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00340              |    0.72167     |       -0.00131      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
11:10:32.234475






/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (8,9,10,11,12,13,14,15,16,17) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
start fitting parametric model.
start simulating.
0          0.00
1          0.16
2          0.04
3          0.26
4          0.28
           ... 
2999619    0.06
2999620    0.02
2999621    0.02
2999622    0.10
2999623    0.04
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.08
3          0.20
4          0.22
           ... 
2999619    0.06
2999620    0.02
2999621    0.00
2999622    0.04
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.04
3          0.26
4          0.28
           ... 
2999619    0.06
2999620    0.02
2999621    0.02
2999622    0.10
2999623    0.04
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.04
3          0.26
4          0.28
           ... 
2999619    0.06
2999620    0.02
2999621    0.02
2999622    0.10
2999623    0.04
Length: 2999624, dtype: float64
0          0.00
1          0.18
2          0.04
3          0.22
4          0.28
           ... 
2999619    0.06
2999620    0.02
2999621    0.02
2999622    0.10
2999623    0.04
Length: 2999624, dtype: float64
0          0.06
1          0.16
2          0.02
3          0.18
4          0.22
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.26
2          0.00
3          0.16
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.26
2          0.00
3          0.16
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.26
2          0.00
3          0.16
4          0.20
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.24
2          0.02
3          0.16
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01639 |             0.03169              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.03764              |    1.18772     |       0.00595       |
|    Treat on Vacuna only at t1   |    NA   |             0.03071              |    0.96890     |       -0.00099      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03030              |    0.95620     |       -0.00139      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03023              |    0.95386     |       -0.00146      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:05:43.080476
start fitting parametric model.
start simulating.
0          0.00
1          0.08
2          0.32
3          0.06
4          0.22
           ... 
2999619    0.04
2999620    0.04
2999621    0.12
2999622    0.02
2999623    0.06
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.32
3          0.06
4          0.22
           ... 
2999619    0.04
2999620    0.04
2999621    0.12
2999622    0.02
2999623    0.06
Length: 2999624, dtype: float64
0          0.02
1          0.04
2          0.38
3          0.08
4          0.20
           ... 
2999619    0.08
2999620    0.04
2999621    0.10
2999622    0.04
2999623    0.10
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.32
3          0.06
4          0.22
           ... 
2999619    0.04
2999620    0.04
2999621    0.12
2999622    0.02
2999623    0.06
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.32
3          0.06
4          0.22
           ... 
2999619    0.04
2999620    0.04
2999621    0.12
2999622    0.02
2999623    0.06
Length: 2999624, dtype: float64
0          0.02
1          0.08
2          0.12
3          0.14
4          0.16
           ... 
2999619    0.00
2999620    0.00
2999621    0.02
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.04
2          0.04
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.06
2          0.04
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.06
2          0.12
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.04
2          0.04
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01605 |             0.03549              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.03917              |    1.10367     |       0.00368       |
|    Treat on Vacuna only at t1   |    NA   |             0.03460              |    0.97477     |       -0.00090      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03437              |    0.96827     |       -0.00113      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03428              |    0.96582     |       -0.00121      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:09:57.255768
start fitting parametric model.
start simulating.
0          0.00
1          0.08
2          0.14
3          0.16
4          0.08
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.14
2999623    0.04
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.06
3          0.06
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.10
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.06
3          0.06
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.10
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.06
3          0.06
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.10
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.06
3          0.14
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.10
2999623    0.02
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.06
3          0.08
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.10
3          0.02
4          0.06
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.10
3          0.02
4          0.06
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64






/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (9,10,11,12,13,14,15,16,17,18) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
start fitting parametric model.
start simulating.
0          0.10
1          0.44
2          0.18
3          0.08
4          0.00
           ... 
2999619    0.06
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.42
2          0.10
3          0.06
4          0.02
           ... 
2999619    0.02
2999620    0.02
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.30
2          0.10
3          0.06
4          0.02
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.30
2          0.10
3          0.06
4          0.02
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.30
2          0.10
3          0.06
4          0.02
           ... 
2999619    0.02
2999620    0.02
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.10
1          0.24
2          0.14
3          0.24
4          0.10
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.12
3          0.22
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.12
3          0.22
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.10
3          0.22
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.12
3          0.22
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01598 |             0.03406              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04641              |    1.36254     |       0.01235       |
|    Treat on Vacuna only at t1   |    NA   |             0.03124              |    0.91733     |       -0.00282      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03040              |    0.89270     |       -0.00365      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03041              |    0.89284     |       -0.00365      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:09:41.233877
start fitting parametric model.
start simulating.
0          0.08
1          0.08
2          0.16
3          0.10
4          0.22
           ... 
2999619    0.02
2999620    0.02
2999621    0.04
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.02
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.02
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.02
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.04
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.02
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.04
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.02
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.02
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.16
1          0.12
2          0.00
3          0.06
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.02
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.02
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.02
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.02
3          0.12
4          0.08
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01616 |             0.03347              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04687              |    1.40035     |       0.01340       |
|    Treat on Vacuna only at t1   |    NA   |             0.02997              |    0.89542     |       -0.00350      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02889              |    0.86307     |       -0.00458      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02908              |    0.86886     |       -0.00439      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:17:50.437625
start fitting parametric model.
start simulating.
0          0.00
1          0.12
2          0.04
3          0.02
4          0.40
           ... 
2999619    0.02
2999620    0.22
2999621    0.06
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.02
3          0.00
4          0.20
           ... 
2999619    0.00
2999620    0.10
2999621    0.04
2999622    0.06
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.02
3          0.00
4          0.20
           ... 
2999619    0.00
2999620    0.10
2999621    0.04
2999622    0.06
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.02
3          0.00
4          0.20
           ... 
2999619    0.00
2999620    0.10
2999621    0.04
2999622    0.06
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.02
3          0.02
4          0.20
           ... 
2999619    0.02
2999620    0.10
2999621    0.04
2999622    0.06
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.10
3          0.02
4          0.30
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.00
2          0.04
3          0.04
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.00
2          0.04
3          0.04
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.04
3          0.04
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.00
2          0.04
3          0.04
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01610 |             0.03174              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04086              |    1.28736     |       0.00912       |
|    Treat on Vacuna only at t1   |    NA   |             0.02980              |    0.93879     |       -0.00194      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02913              |    0.91762     |       -0.00261      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02901              |    0.91397     |       -0.00273      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:26:50.635995
start fitting parametric model.
start simulating.
0          0.26
1          0.28
2          0.00
3          0.14
4          0.14
           ... 
2999619    0.06
2999620    0.00
2999621    0.00
2999622    0.14
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.00
3          0.08
4          0.08
           ... 
2999619    0.06
2999620    0.00
2999621    0.02
2999622    0.06
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.00
3          0.08
4          0.08
           ... 
2999619    0.04
2999620    0.00
2999621    0.02
2999622    0.06
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.00
3          0.14
4          0.08
           ... 
2999619    0.06
2999620    0.00
2999621    0.02
2999622    0.06
2999623    0.02
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.00
3          0.08
4          0.08
           ... 
2999619    0.04
2999620    0.00
2999621    0.02
2999622    0.06
2999623    0.02
Length: 2999624, dtype: float64
0          0.26
1          0.16
2          0.06
3          0.26
4          0.30
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.02
3          0.26
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.02
3          0.30
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.06
3          0.26
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.10
2          0.02
3          0.30
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01597 |             0.03111              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04152              |    1.33475     |       0.01041       |
|    Treat on Vacuna only at t1   |    NA   |             0.02898              |    0.93176     |       -0.00212      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02847              |    0.91514     |       -0.00264      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02833              |    0.91063     |       -0.00278      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:35:31.935794
start fitting parametric model.
start simulating.
0          0.02
1          0.18
2          0.30
3          0.04
4          0.10
           ... 
2999619    0.12
2999620    0.12
2999621    0.08
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.30
3          0.04
4          0.10
           ... 
2999619    0.12
2999620    0.12
2999621    0.08
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.04
1          0.28
2          0.40
3          0.04
4          0.16
           ... 
2999619    0.12
2999620    0.16
2999621    0.22
2999622    0.12
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.30
3          0.04
4          0.10
           ... 
2999619    0.12
2999620    0.12
2999621    0.08
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.12
2          0.30
3          0.04
4          0.10
           ... 
2999619    0.14
2999620    0.12
2999621    0.08
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.18
2          0.18
3          0.10
4          0.00
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.18
2          0.18
3          0.10
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.16
2          0.18
3          0.10
4          0.00
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.14
2          0.18
3          0.18
4          0.02
           ... 
2999619    0.02
2999620    0.04
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.18
3          0.16
4          0.02
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01600 |             0.03289              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04416              |    1.34254     |       0.01127       |
|    Treat on Vacuna only at t1   |    NA   |             0.03071              |    0.93362     |       -0.00218      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02924              |    0.88894     |       -0.00365      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02917              |    0.88679     |       -0.00372      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
5:44:50.336577
start fitting parametric model.
start simulating.
0          0.00
1          0.02
2          0.08
3          0.00
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.02
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.08
3          0.00
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.02
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.04
3          0.08
4          0.12
           ... 
2999619    0.02
2999620    0.00
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.10
3          0.00
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.02
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.08
3          0.00
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.02
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.12
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.00
2          0.06
3          0.12
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.14
2          0.04
3          0.20
4          0.22
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.12
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.02
2          0.04
3          0.12
4          0.18
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01602 |             0.03043              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04261              |    1.40035     |       0.01218       |
|    Treat on Vacuna only at t1   |    NA   |             0.02815              |    0.92528     |       -0.00227      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02738              |    0.89999     |       -0.00304      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02722              |    0.89458     |       -0.00321      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:53:50.958334
start fitting parametric model.
start simulating.
0          0.28
1          0.22
2          0.04
3          0.08
4          0.16
           ... 
2999619    0.02
2999620    0.06
2999621    0.04
2999622    0.04
2999623    0.08
Length: 2999624, dtype: float64
0          0.04
1          0.16
2          0.02
3          0.06
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.04
1          0.16
2          0.02
3          0.06
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.04
1          0.16
2          0.04
3          0.10
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.04
1          0.16
2          0.02
3          0.06
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.30
1          0.12
2          0.00
3          0.22
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.12
2          0.00
3          0.14
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.12
2          0.00
3          0.08
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.12
2          0.00
3          0.24
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.16
2          0.00
3          0.08
4          0.14
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01600 |             0.03082              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04325              |    1.40336     |       0.01243       |
|    Treat on Vacuna only at t1   |    NA   |             0.02825              |    0.91661     |       -0.00257      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02742              |    0.88980     |       -0.00340      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02727              |    0.88493     |       -0.00355      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
8:03:49.020598
start fitting parametric model.
start simulating.
0          0.02
1          0.44
2          0.24
3          0.10
4          0.34
           ... 
2999619    0.00
2999620    0.04
2999621    0.04
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.18
2          0.16
3          0.10
4          0.10
           ... 
2999619    0.00
2999620    0.00
2999621    0.06
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.16
3          0.06
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.06
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.16
3          0.06
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.06
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.16
3          0.06
4          0.10
           ... 
2999619    0.02
2999620    0.00
2999621    0.06
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.20
2          0.38
3          0.12
4          0.38
           ... 
2999619    0.00
2999620    0.00
2999621    0.04
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.20
2          0.26
3          0.12
4          0.20
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.26
3          0.12
4          0.20
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.26
3          0.12
4          0.20
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.18
2          0.26
3          0.12
4          0.20
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01604 |             0.03207              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04667              |    1.45549     |       0.01461       |
|    Treat on Vacuna only at t1   |    NA   |             0.03008              |    0.93803     |       -0.00199      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02952              |    0.92051     |       -0.00255      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02933              |    0.91462     |       -0.00274      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:12:47.003749
start fitting parametric model.
start simulating.
0          0.00
1          0.14
2          0.12
3          0.06
4          0.24
           ... 
2999619    0.00
2999620    0.04
2999621    0.00
2999622    0.08
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.06
3          0.04
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.06
3          0.04
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.06
3          0.04
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.04
2          0.06
3          0.02
4          0.14
           ... 
2999619    0.00
2999620    0.02
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.10
3          0.16
4          0.10
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.06
3          0.18
4          0.04
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.06
3          0.16
4          0.10
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.06
3          0.18
4          0.04
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.06
3          0.16
4          0.04
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01640 |             0.03241              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04487              |    1.38457     |       0.01246       |
|    Treat on Vacuna only at t1   |    NA   |             0.03020              |    0.93172     |       -0.00221      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02974              |    0.91754     |       -0.00267      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02969              |    0.91599     |       -0.00272      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
10:22:13.602813
start fitting parametric model.
start simulating.
0          0.02
1          0.36
2          0.04
3          0.12
4          0.04
           ... 
2999619    0.16
2999620    0.00
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.10
1          0.44
2          0.08
3          0.12
4          0.06
           ... 
2999619    0.16
2999620    0.02
2999621    0.00
2999622    0.06
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.36
2          0.04
3          0.08
4          0.04
           ... 
2999619    0.16
2999620    0.00
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.36
2          0.04
3          0.08
4          0.04
           ... 
2999619    0.16
2999620    0.00
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.02
1          0.36
2          0.04
3          0.08
4          0.04
           ... 
2999619    0.16
2999620    0.00
2999621    0.00
2999622    0.02
2999623    0.00
Length: 2999624, dtype: float64
0          0.08
1          0.12
2          0.20
3          0.36
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.12
2          0.08
3          0.32
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.08
3          0.20
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.06
2          0.08
3          0.32
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
0          0.00
1          0.08
2          0.08
3          0.20
4          0.12
           ... 
2999619    0.00
2999620    0.00
2999621    0.00
2999622    0.00
2999623    0.00
Length: 2999624, dtype: float64
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01598 |             0.03377              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04744              |    1.40473     |       0.01367       |
|    Treat on Vacuna only at t1   |    NA   |             0.03121              |    0.92414     |       -0.00256      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03020              |    0.89438     |       -0.00357      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03023              |    0.89521     |       -0.00354      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
11:31:40.175996
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 26, in <module>
    grace_period = datetime.timedelta(days=grace_period_days)
AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 26, in <module>
    grace_period = datetime.timedelta(days=grace_period_days)
AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 26, in <module>
    grace_period = datetime.timedelta(days=grace_period_days)
AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 26, in <module>
    grace_period = datetime.timedelta(days=grace_period_days)
AttributeError: type object 'datetime.datetime' has no attribute 'timedelta'
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 18, in <module>
    startTime = datetime.now()
AttributeError: module 'datetime' has no attribute 'now'








/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 28, in <module>
    data_all['VACUNA_1_DATA'] = pd.to_datetime(data_all['VACUNA_1_DATA'])
NameError: name 'data_all' is not defined
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 28, in <module>
    data_all['VACUNA_1_DATA'] = pd.to_datetime(data_all['VACUNA_1_DATA'])
NameError: name 'data_all' is not defined








/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.07700698487544
start fitting parametric model.
start simulating.
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/_utils.py", line 72, in __call__
    return self.func(**kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 598, in __call__
    return [func(*args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 598, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/simulate.py", line 254, in simulate
    new_df[outcome_name] = new_df['prob1'].apply(binorm_sample)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/series.py", line 4924, in apply
    ).apply()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/apply.py", line 1427, in apply
    return self.apply_standard()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/simulate.py", line 16, in binorm_sample
    return np.random.binomial(n=1, p=prob, size=1)[0]
  File "numpy/random/mtrand.pyx", line 3486, in numpy.random.mtrand.RandomState.binomial
  File "_common.pyx", line 430, in numpy.random._common.check_constraint
ValueError: p < 0, p > 1 or p is NaN
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 214, in <module>
    g.fit()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/parametric_gformula.py", line 579, in fit
    Parallel(n_jobs=self.ncores, prefer="threads") # Consider trying prefer="threads"  prefer="threads"
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1754, in _retrieve
    self._raise_error_fast()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1789, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 745, in get_result
    return self._return_or_raise()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 763, in _return_or_raise
    raise self._result
ValueError: p < 0, p > 1 or p is NaN
% of uncensored
38.47762252869026
start fitting parametric model.
start simulating.
joblib.externals.loky.process_executor._RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/_utils.py", line 72, in __call__
    return self.func(**kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 598, in __call__
    return [func(*args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 598, in <listcomp>
    return [func(*args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/simulate.py", line 254, in simulate
    new_df[outcome_name] = new_df['prob1'].apply(binorm_sample)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/series.py", line 4924, in apply
    ).apply()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/apply.py", line 1427, in apply
    return self.apply_standard()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/apply.py", line 1507, in apply_standard
    mapped = obj._map_values(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/base.py", line 921, in _map_values
    return algorithms.map_array(arr, mapper, na_action=na_action, convert=convert)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pandas/core/algorithms.py", line 1743, in map_array
    return lib.map_infer(values, mapper, convert=convert)
  File "lib.pyx", line 2972, in pandas._libs.lib.map_infer
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/simulate.py", line 16, in binorm_sample
    return np.random.binomial(n=1, p=prob, size=1)[0]
  File "numpy/random/mtrand.pyx", line 3486, in numpy.random.mtrand.RandomState.binomial
  File "_common.pyx", line 430, in numpy.random._common.check_constraint
ValueError: p < 0, p > 1 or p is NaN
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 214, in <module>
    g.fit()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/parametric_gformula.py", line 579, in fit
    Parallel(n_jobs=self.ncores, prefer="threads") # Consider trying prefer="threads"  prefer="threads"
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 2007, in __call__
    return output if self.return_generator else list(output)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1650, in _get_outputs
    yield from self._retrieve()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1754, in _retrieve
    self._raise_error_fast()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 1789, in _raise_error_fast
    error_job.get_result(self.timeout)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 745, in get_result
    return self._return_or_raise()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/parallel.py", line 763, in _return_or_raise
    raise self._result
ValueError: p < 0, p > 1 or p is NaN





/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
38.58416921587506
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01756 |             0.00404              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00465              |    1.15038     |       0.00061       |
|    Treat on Vacuna only at t1   |    NA   |             0.00401              |    0.99311     |       -0.00003      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00400              |    0.99077     |       -0.00004      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00391              |    0.96890     |       -0.00013      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:40:34.278244
% of uncensored
38.57963531429272
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01777 |             0.00680              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00901              |    1.32439     |       0.00221       |
|    Treat on Vacuna only at t1   |    NA   |             0.00669              |    0.98325     |       -0.00011      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00664              |    0.97560     |       -0.00017      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00642              |    0.94336     |       -0.00039      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:13:59.014164
% of uncensored
38.526828695863216
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01802 |             0.00673              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00787              |    1.16810     |       0.00113       |
|    Treat on Vacuna only at t1   |    NA   |             0.00670              |    0.99502     |       -0.00003      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00669              |    0.99331     |       -0.00005      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00662              |    0.98267     |       -0.00012      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:47:50.672732
% of uncensored
38.49295778404226
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01758 |             0.00804              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00852              |    1.06059     |       0.00049       |
|    Treat on Vacuna only at t1   |    NA   |             0.00800              |    0.99587     |       -0.00003      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00799              |    0.99370     |       -0.00005      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00779              |    0.96959     |       -0.00024      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:21:45.642433
% of uncensored
38.4236157598419
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01764 |             0.00489              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00637              |    1.30133     |       0.00147       |
|    Treat on Vacuna only at t1   |    NA   |             0.00482              |    0.98591     |       -0.00007      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00480              |    0.98078     |       -0.00009      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00463              |    0.94612     |       -0.00026      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
7:56:39.768626
% of uncensored
38.480689579760664
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01768 |             0.00756              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00893              |    1.18149     |       0.00137       |
|    Treat on Vacuna only at t1   |    NA   |             0.00751              |    0.99328     |       -0.00005      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00749              |    0.99064     |       -0.00007      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00739              |    0.97805     |       -0.00017      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:31:35.536150
% of uncensored
38.57110091131422
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01773 |             0.00485              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00749              |    1.54344     |       0.00264       |
|    Treat on Vacuna only at t1   |    NA   |             0.00479              |    0.98825     |       -0.00006      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00477              |    0.98453     |       -0.00008      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00454              |    0.93602     |       -0.00031      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
11:06:40.795165
% of uncensored
38.44628526775356
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01751 |             0.00604              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00665              |    1.09968     |       0.00060       |
|    Treat on Vacuna only at t1   |    NA   |             0.00602              |    0.99611     |       -0.00002      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00601              |    0.99490     |       -0.00003      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00596              |    0.98542     |       -0.00009      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
12:41:57.897743
% of uncensored
38.486556981808384
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01812 |             0.00569              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00753              |    1.32526     |       0.00185       |
|    Treat on Vacuna only at t1   |    NA   |             0.00559              |    0.98276     |       -0.00010      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00558              |    0.98076     |       -0.00011      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00545              |    0.95892     |       -0.00023      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
14:17:04.284933
% of uncensored
38.45148591956858
start fitting parametric model.
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01775 |             0.00539              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00741              |    1.37480     |       0.00202       |
|    Treat on Vacuna only at t1   |    NA   |             0.00535              |    0.99224     |       -0.00004      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00534              |    0.98996     |       -0.00005      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00512              |    0.94971     |       -0.00027      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
15:52:53.395411
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')







5/8/2024

/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
38.4913575834838
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01747 |             0.04504              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.06528              |    1.44958     |       0.02025       |
|    Treat on Vacuna only at t1   |    NA   |             0.04301              |    0.95510     |       -0.00202      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.04249              |    0.94341     |       -0.00255      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.04242              |    0.94181     |       -0.00262      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:30:21.965901
% of uncensored
38.58656951671276
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01777 |             0.03779              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.06651              |    1.76023     |       0.02873       |
|    Treat on Vacuna only at t1   |    NA   |             0.03503              |    0.92719     |       -0.00275      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03427              |    0.90697     |       -0.00352      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03417              |    0.90429     |       -0.00362      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:00:51.546995
% of uncensored
38.463754123850194
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 6 leaked semlock objects to clean up at shutdown
  warnings.warn(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 6 leaked folder objects to clean up at shutdown
  warnings.warn(
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
38.54296405149446
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05395 |             0.15566              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23984              |    1.54072     |       0.08417       |
|    Treat on Vacuna only at t1   |    NA   |             0.15099              |    0.96998     |       -0.00467      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.15012              |    0.96439     |       -0.00554      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.13535              |    0.86948     |       -0.02032      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:29:51.315998
% of uncensored
38.42534931044691
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05370 |             0.15365              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23300              |    1.51643     |       0.07935       |
|    Treat on Vacuna only at t1   |    NA   |             0.14982              |    0.97505     |       -0.00383      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.14851              |    0.96652     |       -0.00514      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12407              |    0.80751     |       -0.02958      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
2:59:28.511405
% of uncensored
38.56176640805648
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05427 |             0.15990              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23562              |    1.47357     |       0.07572       |
|    Treat on Vacuna only at t1   |    NA   |             0.15574              |    0.97401     |       -0.00416      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.15533              |    0.97145     |       -0.00456      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.13625              |    0.85212     |       -0.02365      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:30:46.272841
% of uncensored
38.564166708894184
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05429 |             0.15822              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.22959              |    1.45107     |       0.07137       |
|    Treat on Vacuna only at t1   |    NA   |             0.15407              |    0.97381     |       -0.00414      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.15301              |    0.96708     |       -0.00521      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.13298              |    0.84045     |       -0.02524      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:01:08.026482
% of uncensored
38.40788045435028
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05380 |             0.15346              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23636              |    1.54023     |       0.08290       |
|    Treat on Vacuna only at t1   |    NA   |             0.14921              |    0.97234     |       -0.00424      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.14806              |    0.96485     |       -0.00539      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12846              |    0.83708     |       -0.02500      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
7:31:33.211014
% of uncensored
38.5220280941878
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05444 |             0.15624              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23805              |    1.52366     |       0.08181       |
|    Treat on Vacuna only at t1   |    NA   |             0.15207              |    0.97335     |       -0.00416      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.15100              |    0.96646     |       -0.00524      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12953              |    0.82904     |       -0.02671      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:02:25.216652
% of uncensored
38.434017063471956
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05413 |             0.14995              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.24215              |    1.61486     |       0.09220       |
|    Treat on Vacuna only at t1   |    NA   |             0.14594              |    0.97325     |       -0.00401      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.14396              |    0.96004     |       -0.00599      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12826              |    0.85536     |       -0.02169      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
10:33:38.165232
% of uncensored
38.56309990852187
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05389 |             0.15551              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23376              |    1.50315     |       0.07825       |
|    Treat on Vacuna only at t1   |    NA   |             0.15177              |    0.97590     |       -0.00375      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.15074              |    0.96928     |       -0.00478      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.13425              |    0.86329     |       -0.02126      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
12:05:30.742476
% of uncensored
38.495224734833435
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05385 |             0.14814              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.23227              |    1.56791     |       0.08413       |
|    Treat on Vacuna only at t1   |    NA   |             0.14414              |    0.97298     |       -0.00400      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.14286              |    0.96437     |       -0.00528      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12491              |    0.84317     |       -0.02323      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
13:37:10.164383
% of uncensored
38.526962045909755
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.05392 |             0.15117              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.22527              |    1.49019     |       0.07410       |
|    Treat on Vacuna only at t1   |    NA   |             0.14787              |    0.97818     |       -0.00330      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.14695              |    0.97213     |       -0.00421      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.12991              |    0.85937     |       -0.02126      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
15:09:00.143532
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')



6/8/24

/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
38.49215768376303
start fitting parametric model.
% of uncensored
38.51469384162815
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 6 leaked semlock objects to clean up at shutdown
  warnings.warn(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 2 leaked folder objects to clean up at shutdown
  warnings.warn(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01878 |             0.09022              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12148              |    1.34649     |       0.03126       |
|    Treat on Vacuna only at t1   |    NA   |             0.08643              |    0.95794     |       -0.00380      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08456              |    0.93721     |       -0.00567      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08629              |    0.95645     |       -0.00393      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:32:38.369537
% of uncensored
38.541897251122144
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01923 |             0.09754              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12588              |    1.29055     |       0.02834       |
|    Treat on Vacuna only at t1   |    NA   |             0.09448              |    0.96856     |       -0.00307      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.09275              |    0.95087     |       -0.00479      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09399              |    0.96353     |       -0.00356      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:03:36.915370
% of uncensored
38.54216395121522
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01948 |             0.08581              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.11705              |    1.36402     |       0.03124       |
|    Treat on Vacuna only at t1   |    NA   |             0.08203              |    0.95589     |       -0.00379      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08037              |    0.93658     |       -0.00544      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08437              |    0.98315     |       -0.00145      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:36:08.836761
% of uncensored
38.50082543678808
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01890 |             0.09173              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12560              |    1.36925     |       0.03387       |
|    Treat on Vacuna only at t1   |    NA   |             0.08742              |    0.95302     |       -0.00431      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08580              |    0.93535     |       -0.00593      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08557              |    0.93282     |       -0.00616      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:08:46.870730
% of uncensored
38.46828802543252
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01901 |             0.08912              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.11918              |    1.33720     |       0.03005       |
|    Treat on Vacuna only at t1   |    NA   |             0.08545              |    0.95874     |       -0.00368      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08373              |    0.93944     |       -0.00540      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08409              |    0.94355     |       -0.00503      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
7:41:49.170606
% of uncensored
38.512293540790445
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01886 |             0.09288              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12327              |    1.32721     |       0.03039       |
|    Treat on Vacuna only at t1   |    NA   |             0.08949              |    0.96357     |       -0.00338      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08812              |    0.94879     |       -0.00476      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09419              |    1.01410     |       0.00131       |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:15:58.297236
% of uncensored
38.526828695863216
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01925 |             0.08800              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.11820              |    1.34320     |       0.03020       |
|    Treat on Vacuna only at t1   |    NA   |             0.08478              |    0.96343     |       -0.00322      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08285              |    0.94149     |       -0.00515      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08365              |    0.95061     |       -0.00435      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
10:49:53.263913
% of uncensored
38.428549711563846
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01908 |             0.09656              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12763              |    1.32181     |       0.03107       |
|    Treat on Vacuna only at t1   |    NA   |             0.09273              |    0.96037     |       -0.00383      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.09088              |    0.94124     |       -0.00567      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09131              |    0.94567     |       -0.00525      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
12:23:35.814073
% of uncensored
38.53549644888826
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01905 |             0.09753              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.12040              |    1.23451     |       0.02287       |
|    Treat on Vacuna only at t1   |    NA   |             0.09519              |    0.97610     |       -0.00233      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.09339              |    0.95756     |       -0.00414      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09491              |    0.97314     |       -0.00262      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
13:57:06.632364
% of uncensored
38.4722885268287
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01930 |             0.08801              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.11582              |    1.31606     |       0.02782       |
|    Treat on Vacuna only at t1   |    NA   |             0.08494              |    0.96515     |       -0.00307      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.08274              |    0.94022     |       -0.00526      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.08179              |    0.92932     |       -0.00622      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
15:31:10.666214




7/8/24
/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.03646857072754
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01682 |             0.02412              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.03361              |    1.39354     |       0.00949       |
|    Treat on Vacuna only at t1   |    NA   |             0.02339              |    0.96971     |       -0.00073      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.02263              |    0.93815     |       -0.00149      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.02245              |    0.93076     |       -0.00167      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:36:28.949494
% of uncensored
92.09327569055321
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01666 |             0.05193              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.07679              |    1.47880     |       0.02486       |
|    Treat on Vacuna only at t1   |    NA   |             0.05014              |    0.96555     |       -0.00179      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.04841              |    0.93222     |       -0.00352      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.04818              |    0.92786     |       -0.00375      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:11:38.430466
% of uncensored
92.0966094417167
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01684 |             0.00519              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00792              |    1.52476     |       0.00273       |
|    Treat on Vacuna only at t1   |    NA   |             0.00507              |    0.97545     |       -0.00013      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00495              |    0.95250     |       -0.00025      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00500              |    0.96338     |       -0.00019      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:50:07.571493
% of uncensored
92.08834173883128
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01643 |             0.01225              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01703              |    1.38961     |       0.00477       |
|    Treat on Vacuna only at t1   |    NA   |             0.01183              |    0.96545     |       -0.00042      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.01152              |    0.94022     |       -0.00073      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01149              |    0.93734     |       -0.00077      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:28:10.068636
% of uncensored
92.10327694404366
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01657 |             0.04794              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.07001              |    1.46022     |       0.02206       |
|    Treat on Vacuna only at t1   |    NA   |             0.04602              |    0.95989     |       -0.00192      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.04446              |    0.92732     |       -0.00348      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.04400              |    0.91783     |       -0.00394      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
8:07:56.511028
% of uncensored
92.0472699244972
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01660 |             0.01554              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.01836              |    1.18116     |       0.00282       |
|    Treat on Vacuna only at t1   |    NA   |             0.01540              |    0.99071     |       -0.00014      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.01515              |    0.97462     |       -0.00039      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01532              |    0.98557     |       -0.00022      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:46:34.920551
% of uncensored
92.0812741863647
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01658 |             0.03295              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.04621              |    1.40254     |       0.01326       |
|    Treat on Vacuna only at t1   |    NA   |             0.03230              |    0.98023     |       -0.00065      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.03162              |    0.95976     |       -0.00133      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.03151              |    0.95620     |       -0.00144      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
11:25:26.365608
% of uncensored
92.03913557165832
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01663 |             0.04897              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.07190              |    1.46819     |       0.02293       |
|    Treat on Vacuna only at t1   |    NA   |             0.04739              |    0.96764     |       -0.00158      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.04595              |    0.93840     |       -0.00302      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.04595              |    0.93839     |       -0.00302      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
13:04:30.857168
% of uncensored
92.0738065837585
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/fit.py:616: RuntimeWarning: divide by zero encountered in divide
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 214, in <module>
    g.fit()
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/parametric_gformula.py", line 531, in fit
    fit_ymodel(ymodel=self.ymodel, ymodel_type=self.ymodel_type, outcome_type=self.outcome_type,
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/fit.py", line 383, in fit_ymodel
    outcome_fit = RandomForestClassifier(n_estimators=50, n_jobs=ncores).fit(fit_data[outcome_model_vars], fit_data[outcome_name], sample_weight=fit_data['weights_CCW'])
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/base.py", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/ensemble/_forest.py", line 383, in fit
    sample_weight = _check_sample_weight(sample_weight, X)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 2004, in _check_sample_weight
    sample_weight = check_array(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 1049, in check_array
    _assert_all_finite(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input sample_weight contains infinity or a value too large for dtype('float64').




/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.09407579083245
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04651 |             0.00277              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00387              |    1.39495     |       0.00110       |
|    Treat on Vacuna only at t1   |    NA   |             0.00269              |    0.97131     |       -0.00008      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00267              |    0.96189     |       -0.00011      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00260              |    0.93814     |       -0.00017      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:33:47.602999
% of uncensored
92.05367072673108
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04629 |             0.09949              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.17655              |    1.77449     |       0.07706       |
|    Treat on Vacuna only at t1   |    NA   |             0.09715              |    0.97644     |       -0.00234      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.09585              |    0.96339     |       -0.00364      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09318              |    0.93655     |       -0.00631      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:12:21.653610
% of uncensored
92.08354113715586
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04656 |             0.10543              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.17750              |    1.68361     |       0.07207       |
|    Treat on Vacuna only at t1   |    NA   |             0.10280              |    0.97505     |       -0.00263      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.10159              |    0.96355     |       -0.00384      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09945              |    0.94329     |       -0.00598      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
4:52:41.768620
% of uncensored
92.04340277314756
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04632 |             0.01802              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.02978              |    1.65282     |       0.01176       |
|    Treat on Vacuna only at t1   |    NA   |             0.01755              |    0.97384     |       -0.00047      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.01738              |    0.96460     |       -0.00064      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.01708              |    0.94813     |       -0.00093      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
6:33:01.458629
% of uncensored
92.1218126005126
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04570 |             0.10710              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.17957              |    1.67666     |       0.07247       |
|    Treat on Vacuna only at t1   |    NA   |             0.10408              |    0.97175     |       -0.00303      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.10255              |    0.95745     |       -0.00456      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09941              |    0.92813     |       -0.00770      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
8:13:57.786838
% of uncensored
92.04580307398528
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04694 |             0.00392              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00432              |    1.10153     |       0.00040       |
|    Treat on Vacuna only at t1   |    NA   |             0.00391              |    0.99560     |       -0.00002      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00390              |    0.99405     |       -0.00002      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00388              |    0.98838     |       -0.00005      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
9:52:42.270167
% of uncensored
92.01073201174547
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/fit.py:616: RuntimeWarning: divide by zero encountered in divide
Traceback (most recent call last):
  File "/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py", line 214, in <module>
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/parametric_gformula.py", line 531, in fit
    fit_ymodel(ymodel=self.ymodel, ymodel_type=self.ymodel_type, outcome_type=self.outcome_type,
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/pygformula-1.0.3-py3.10.egg/pygformula/parametric_gformula/fit.py", line 367, in fit_ymodel
    outcome_fit = RandomForestClassifier(n_estimators=50, n_jobs=ncores).fit(fit_data[outcome_model_vars], fit_data[outcome_name], sample_weight=fit_data['weights_CCW'])
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/base.py", line 1474, in wrapper
    return fit_method(estimator, *args, **kwargs)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/ensemble/_forest.py", line 383, in fit
    sample_weight = _check_sample_weight(sample_weight, X)
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 2004, in _check_sample_weight
    sample_weight = check_array(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 1049, in check_array
    _assert_all_finite(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 126, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/utils/validation.py", line 175, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input sample_weight contains infinity or a value too large for dtype('float64').



9/8/2024

python: can't open file '/home/bvelasco/CovidVax_DM/covidvax_DM_pygformula_chunks_CCW.py': [Errno 2] No such file or directory
/home/bvelasco/CovidVax_DM/3_gformula_whole_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.04913682514875
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04599 |             0.10559              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.17508              |    1.65814     |       0.06949       |
|    Treat on Vacuna only at t1   |    NA   |             0.10309              |    0.97632     |       -0.00250      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.10193              |    0.96532     |       -0.00366      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.09989              |    0.94608     |       -0.00569      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:40:48.700216
% of uncensored
92.11447834795294
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(



/home/bvelasco/CovidVax_DM/3_gformula_whole_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.10447709446251
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04648 |             0.10767              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.18147              |    1.68538     |       0.07380       |
|    Treat on Vacuna only at t1   |    NA   |             0.10480              |    0.97330     |       -0.00287      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.10340              |    0.96032     |       -0.00427      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.10101              |    0.93816     |       -0.00666      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
3:24:39.714930
% of uncensored
92.06287187994229
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 6 leaked semlock objects to clean up at shutdown
  warnings.warn(
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/joblib/externals/loky/backend/resource_tracker.py:314: UserWarning: resource_tracker: There appear to be 2 leaked folder objects to clean up at shutdown
  warnings.warn(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP risk | g-formula risk (NICE-parametric) | Risk Ratio(RR) | Risk Difference(RD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.04660 |             0.00468              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.00744              |    1.59077     |       0.00276       |
|    Treat on Vacuna only at t1   |    NA   |             0.00455              |    0.97240     |       -0.00013      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.00449              |    0.96024     |       -0.00019      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.00435              |    0.93066     |       -0.00032      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
5:08:01.030178
/home/bvelasco/CovidVax_DM/3_gformula_whole_chunks_CCW.py:21: DtypeWarning: Columns (7,8,9,10,11,12,16) have mixed types. Specify dtype option on import or set low_memory=False.
  all_data = pd.read_csv('included_cohort_prep.csv')
% of uncensored
92.05833797835994
start fitting parametric model.
/home/bvelasco/miniconda3/envs/python3.10/lib/python3.10/site-packages/sklearn/linear_model/_logistic.py:469: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
start simulating.
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|           Intervention          | NP mean | g-formula mean (NICE-parametric) | Mean Ratio(MR) | Mean Difference(MD) |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
|       Natural course(ref)       | 0.01645 |             0.05313              |    1.00000     |       0.00000       |
|           Never treat           |    NA   |             0.07517              |    1.41473     |       0.02204       |
|    Treat on Vacuna only at t1   |    NA   |             0.05180              |    0.97491     |       -0.00133      |
| Treat on Vacuna only at t1 & t2 |    NA   |             0.05069              |    0.95398     |       -0.00245      |
|  Treat on Vacuna at t1, t2 & t3 |    NA   |             0.05015              |    0.94384     |       -0.00298      |
+---------------------------------+---------+----------------------------------+----------------+---------------------+
1:31:33.562379
